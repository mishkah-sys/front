<!DOCTYPE html>
<html lang="ar" dir="rtl" data-htmlx="main" data-css-library="mi" data-theme="dark">

<head>
    <meta charset="utf-8">
    <title>Test HTMLx - Mishkah Framework</title>
    <!-- Mishkah Auto Loader -->
    <script src="../mishkah.js" data-htmlx data-ui data-debug="true" data-dev="true"></script>
    <style>
        [data-theme="light"] .gradient-header-text {
            color: #1e40af !important;
            text-shadow: none !important;
        }

        [data-theme="light"] .counter-number {
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
        }
    </style>
</head>

<body>
    <div id="app"></div>

    <template id="main">
        <script type="application/json" data-m-path="env">
      {"theme":"dark","lang":"ar","dir":"rtl"}
    </script>

        <script type="application/json" data-m-path="data">
      {"count":0}
    </script>

        <script type="application/json" data-m-path="i18n.dict">
      {
        "title": {"ar":"Ù…Ø´ÙƒØ§Ø©","en":"Mishkah"},
        "subtitle": {"ar":"Ø¥Ø·Ø§Ø± Ø¹Ù…Ù„ Ø­Ø¯ÙŠØ« Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„ÙˆÙŠØ¨","en":"Modern Web Framework"},
        "theme": {"ar":"Ø§Ù„Ù…Ø¸Ù‡Ø±","en":"Theme"},
        "lang": {"ar":"Ø§Ù„Ù„ØºØ©","en":"Language"},
        "counter": {"ar":"Ø§Ù„Ø¹Ø¯Ø§Ø¯","en":"Counter"},
        "current_value": {"ar":"Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©","en":"Current Value"},
        "increment": {"ar":"Ø²ÙŠØ§Ø¯Ø©","en":"Increment"},
        "reset": {"ar":"Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†","en":"Reset"},
        "description": {"ar":"Ø§Ø®ØªØ¨Ø± ØªÙØ§Ø¹Ù„ÙŠØ© HTMLx Ù…Ø¹ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù…Ø§Øª ÙˆØ§Ù„Ù„ØºØ§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ","en":"Test HTMLx reactivity with real-time theme and language switching"}
      }
    </script>

        <div
            class="min-h-screen bg-gradient-to-br from-[var(--background)] via-[var(--background)] to-[var(--muted)] relative overflow-hidden">
            <!-- Animated Background -->
            <div class="absolute inset-0 opacity-30">
                <div class="absolute top-20 left-20 w-96 h-96 bg-[var(--primary)] rounded-full blur-3xl animate-pulse">
                </div>
                <div class="absolute bottom-20 right-20 w-96 h-96 bg-[var(--accent)] rounded-full blur-3xl animate-pulse"
                    style="animation-delay: 2s;"></div>
            </div>

            <div class="relative container mx-auto px-4 py-12">
                <div class="max-w-4xl mx-auto space-y-8">

                    <!-- Header -->
                    <div class="text-center space-y-4 mb-12">
                        <div class="inline-flex items-center gap-3 mb-4">
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-[var(--primary)] to-[var(--accent)] rounded-xl flex items-center justify-center shadow-lg">
                                <span class="text-2xl">âš¡</span>
                            </div>
                            <h1
                                class="text-5xl font-black bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] bg-clip-text text-transparent">
                                {t('title')}
                            </h1>
                        </div>
                        <p class="text-lg text-[var(--muted-foreground)] max-w-2xl mx-auto">
                            {t('subtitle')}
                        </p>

                        <!-- Switchers -->
                        <div class="flex justify-center gap-4 pt-4">
                            <ThemeSwitcher onclick="setTheme(event, ctx)" theme={state.env.theme} />
                            <LangSwitcher onclick="setLang(event, ctx)" lang={state.env.lang} />
                        </div>
                    </div>

                    <!-- Main Card -->
                    <div
                        class="backdrop-blur-xl bg-[var(--card)]/80 border border-[var(--border)]/50 rounded-3xl shadow-2xl overflow-hidden">

                        <!-- Card Header with Gradient -->
                        <div
                            class="relative p-8 bg-gradient-to-br from-[var(--primary)] via-[var(--primary)]/90 to-[var(--accent)] overflow-hidden">
                            <div class="absolute inset-0 bg-grid-white/10"></div>
                            <div class="relative">
                                <h2 class="text-2xl font-bold text-white mb-2">{t('counter')}</h2>
                                <p class="text-sm font-medium text-white/80 gradient-header-text">{t('description')}</p>
                            </div>
                        </div>

                        <!-- Card Body -->
                        <div class="p-12">
                            <div class="text-center space-y-8">

                                <!-- Counter Display -->
                                <div class="relative inline-block">
                                    <div
                                        class="absolute inset-0 bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] rounded-full blur-2xl opacity-30 animate-pulse">
                                    </div>
                                    <div class="relative">
                                        <div
                                            class="w-40 h-40 bg-gradient-to-br from-[var(--muted)] to-[var(--muted)]/50 rounded-full border-4 border-[var(--primary)] flex items-center justify-center shadow-2xl backdrop-blur-sm">
                                            <span
                                                class="text-6xl font-black bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] bg-clip-text text-transparent counter-number">
                                                {state.data.count}
                                            </span>
                                        </div>
                                        <div
                                            class="absolute -bottom-3 left-1/2 -translate-x-1/2 px-4 py-1 bg-[var(--card)] border border-[var(--border)] rounded-full shadow-lg">
                                            <p
                                                class="text-xs font-semibold text-[var(--muted-foreground)] whitespace-nowrap">
                                                {t('current_value')}
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div class="flex justify-center gap-4">
                                    <button onclick="increment(event, ctx)"
                                        class="group relative px-8 py-4 bg-gradient-to-r from-[var(--primary)] to-[var(--accent)] text-white rounded-2xl font-bold text-lg shadow-lg hover:shadow-2xl transition-all duration-300 hover:scale-105 active:scale-95 overflow-hidden">
                                        <span
                                            class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>
                                        <span class="relative flex items-center gap-2">
                                            <span>â•</span>
                                            {t('increment')}
                                        </span>
                                    </button>

                                    <button onclick="reset(event, ctx)"
                                        class="px-8 py-4 bg-[var(--muted)] hover:bg-[var(--muted)]/80 text-[var(--foreground)] rounded-2xl font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 active:scale-95 border border-[var(--border)]">
                                        <span class="flex items-center gap-2">
                                            <span>ğŸ”„</span>
                                            {t('reset')}
                                        </span>
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- Debug Info -->
                    <div
                        class="backdrop-blur-xl bg-[var(--card)]/50 border border-[var(--border)]/30 rounded-2xl p-6 shadow-lg">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                            <p class="text-xs font-semibold text-[var(--muted-foreground)] uppercase tracking-wider">
                                System Status</p>
                        </div>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div class="space-y-1">
                                <p class="text-xs text-[var(--muted-foreground)]">Theme</p>
                                <p class="font-mono font-bold text-[var(--foreground)]">{state.env.theme}</p>
                            </div>
                            <div class="space-y-1">
                                <p class="text-xs text-[var(--muted-foreground)]">Language</p>
                                <p class="font-mono font-bold text-[var(--foreground)]">{state.env.lang}</p>
                            </div>
                            <div class="space-y-1">
                                <p class="text-xs text-[var(--muted-foreground)]">Direction</p>
                                <p class="font-mono font-bold text-[var(--foreground)]">{state.env.dir}</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <script>
            function increment(e, ctx) {
                ctx.setState(function (s) {
                    s.data.count++;
                    return s;
                });
            }

            function reset(e, ctx) {
                ctx.setState(function (s) {
                    s.data.count = 0;
                    return s;
                });
            }

            // Theme Logic
            function setTheme(e, ctx) {
                const btn = e.target.closest('button');
                if (!btn) return;

                const theme = btn.dataset.value;

                ctx.setState(function (s) {
                    s.env.theme = theme;
                    return s;
                });

                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                window.dispatchEvent(new CustomEvent('theme-change', { detail: theme }));
            }

            // Language Logic
            function setLang(e, ctx) {
                const btn = e.target.closest('button');
                if (!btn) return;

                const lang = btn.dataset.value;

                ctx.setState(function (s) {
                    s.env.lang = lang;
                    s.env.dir = lang === 'ar' ? 'rtl' : 'ltr';
                    return s;
                });

                document.documentElement.lang = lang;
                document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                localStorage.setItem('lang', lang);
            }

        </script>
    </template>
</body>

</html>